Author: renovate[bot] <29139614+renovate[bot]@users.noreply.github.com>
Date:   Tue May 16 19:12:07 2023 +0000
Subject: Revert 6b48e9962cfec5ffb89b40e9e924ccd80ba8df0a

    fix(deps): update module github.com/docker/docker to v24
    
    Also reflect removed/deprecated fields in the compat API.

Index: libpod/pkg/api/handlers/compat/auth.go
===================================================================
--- libpod.orig/pkg/api/handlers/compat/auth.go
+++ libpod/pkg/api/handlers/compat/auth.go
@@ -15,11 +15,11 @@ import (
 	"github.com/containers/podman/v4/pkg/api/handlers/utils"
 	api "github.com/containers/podman/v4/pkg/api/types"
 	"github.com/containers/podman/v4/pkg/domain/entities"
-	"github.com/docker/docker/api/types/registry"
+	docker "github.com/docker/docker/api/types"
 )
 
 func Auth(w http.ResponseWriter, r *http.Request) {
-	var authConfig registry.AuthConfig
+	var authConfig docker.AuthConfig
 	err := json.NewDecoder(r.Body).Decode(&authConfig)
 	if err != nil {
 		utils.Error(w, http.StatusInternalServerError, fmt.Errorf("failed to parse request: %w", err))
Index: libpod/pkg/api/handlers/compat/info.go
===================================================================
--- libpod.orig/pkg/api/handlers/compat/info.go
+++ libpod/pkg/api/handlers/compat/info.go
@@ -62,6 +62,8 @@ func GetInfo(w http.ResponseWriter, r *h
 			CPUSet:             sysInfo.Cpuset,
 			CPUShares:          sysInfo.CPUShares,
 			CgroupDriver:       configInfo.Engine.CgroupManager,
+			ClusterAdvertise:   "",
+			ClusterStore:       "",
 			ContainerdCommit:   docker.Commit{},
 			Containers:         infoData.Store.ContainerStore.Number,
 			ContainersPaused:   stateInfo[define.ContainerStatePaused],
Index: libpod/pkg/auth/auth.go
===================================================================
--- libpod.orig/pkg/auth/auth.go
+++ libpod/pkg/auth/auth.go
@@ -10,7 +10,7 @@ import (
 
 	imageAuth "github.com/containers/image/v5/pkg/docker/config"
 	"github.com/containers/image/v5/types"
-	dockerAPITypes "github.com/docker/docker/api/types/registry"
+	dockerAPITypes "github.com/docker/docker/api/types"
 	"github.com/sirupsen/logrus"
 )
 
Index: libpod/pkg/specgen/generate/kube/kube.go
===================================================================
--- libpod.orig/pkg/specgen/generate/kube/kube.go
+++ libpod/pkg/specgen/generate/kube/kube.go
@@ -35,7 +35,7 @@ import (
 	"github.com/containers/podman/v4/pkg/specgen/generate"
 	systemdDefine "github.com/containers/podman/v4/pkg/systemd/define"
 	"github.com/containers/podman/v4/pkg/util"
-	"github.com/docker/docker/pkg/meminfo"
+	"github.com/docker/docker/pkg/system"
 	"github.com/docker/go-units"
 	spec "github.com/opencontainers/runtime-spec/specs-go"
 	"github.com/sirupsen/logrus"
@@ -1122,7 +1122,7 @@ func getContainerResources(container v1.
 	requests := container.Resources.Requests
 
 	if limits == nil || limits.Memory().IsZero() {
-		mi, err := meminfo.Read()
+		mi, err := system.ReadMemInfo()
 		if err != nil {
 			return result, err
 		}
Index: libpod/pkg/specgen/generate/kube/play_test.go
===================================================================
--- libpod.orig/pkg/specgen/generate/kube/play_test.go
+++ libpod/pkg/specgen/generate/kube/play_test.go
@@ -15,7 +15,7 @@ import (
 	v12 "github.com/containers/podman/v4/pkg/k8s.io/apimachinery/pkg/apis/meta/v1"
 	"github.com/containers/podman/v4/pkg/k8s.io/apimachinery/pkg/util/intstr"
 	"github.com/containers/podman/v4/pkg/specgen"
-	"github.com/docker/docker/pkg/meminfo"
+	"github.com/docker/docker/pkg/system"
 	"github.com/stretchr/testify/assert"
 	"sigs.k8s.io/yaml"
 )
@@ -448,7 +448,7 @@ func TestEnvVarValue(t *testing.T) {
 	secretsManager := createSecrets(t, d)
 	stringNumCPUs := strconv.Itoa(runtime.NumCPU())
 
-	mi, err := meminfo.Read()
+	mi, err := system.ReadMemInfo()
 	assert.Nil(t, err)
 	stringMemTotal := strconv.FormatInt(mi.MemTotal, 10)
 
